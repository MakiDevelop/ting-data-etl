# 91app è…³æœ¬ç›¤é»æ¸…å–®

> æœ€å¾Œæ›´æ–°ï¼š2026-01-29
> ç›¤é»ç›®çš„ï¼šé‡æ¸…å„è…³æœ¬ç”¨é€”ã€ä½¿ç”¨é »ç‡ã€æ˜¯å¦æ‡‰ä¿ç•™

---

## ç›¤é»ç¸½è¦½

| åˆ†é¡ | æ•¸é‡ | ç‹€æ…‹ |
|------|------|------|
| æ ¸å¿ƒå·¥å…· | 5 | æŒçºŒä½¿ç”¨ |
| Looker ç³»åˆ— | 6 | éƒ¨åˆ†é‡ç–Š |
| é©—è­‰å·¥å…· | 3 | æŒçºŒä½¿ç”¨ |
| XGB è½‰æ› | 2 | æŒçºŒä½¿ç”¨ |
| Web æœå‹™ | 1 | å·²éƒ¨ç½² |
| ä¸€æ¬¡æ€§è…³æœ¬ | 2 | å¯å°å­˜ |

---

## 1. æ ¸å¿ƒå·¥å…·ï¼ˆæŒçºŒä½¿ç”¨ï¼‰

| è…³æœ¬ | ç”¨é€” | è¡Œæ•¸ | ç‹€æ…‹ |
|------|------|------|------|
| `fan_out_by_storeid.py` | ä¾å•†åº—åºè™Ÿæ‹†åˆ† CSV | ~100 | âœ… ä½¿ç”¨ä¸­ |
| `aggregate_by_store.py` | ä¾å•†åº—èšåˆåˆ†æï¼ˆ27 ç¨®é…ç½®ï¼‰ | 1343 | âœ… ä½¿ç”¨ä¸­ |
| `csv_chunk_merger.py` | åˆä½µåˆ†æ®µä¸‹è¼‰çš„ CSV | ~80 | âœ… ä½¿ç”¨ä¸­ |
| `csv_gen.py` | ç”¢ç”Ÿæ¸¬è©¦ç”¨ CSV è³‡æ–™ | ~100 | ğŸ”§ é–‹ç™¼è¼”åŠ© |
| `hash-mapper-web/app.py` | Hash è½‰æ› Web æœå‹™ | ~150 | âœ… å·²éƒ¨ç½² |

---

## 2. Looker ç³»åˆ—ï¼ˆå·²æ•´åˆï¼‰

| è…³æœ¬ | ç”¨é€” | ç‹€æ…‹ |
|------|------|------|
| `looker_downloader.py` | **æ•´åˆç‰ˆä¸‹è¼‰å™¨** â€” æ”¯æ´ custom/stable/slow ä¸‰ç¨®æ¨¡å¼ | âœ… ä½¿ç”¨ä¸­ |
| `looker_query_inspector.py` | æª¢æŸ¥ query è©³ç´°è³‡è¨Š | ğŸŸ¢ ä¿ç•™ |
| `looker_hash_mapper.py` | å»ºç«‹ hash mapping DB | ğŸŸ¢ ä¿ç•™ |
| `looker_hash_mapper_merge.py` | åˆä½µæ–°è³‡æ–™åˆ°ç¾æœ‰ DB | ğŸŸ¢ ä¿ç•™ |

**æ•´åˆç‰ˆä½¿ç”¨æ–¹å¼**ï¼š
```bash
# custom æ¨¡å¼ - å»ºç«‹æ–° query
python3 looker_downloader.py custom --from 2025/01/01 --to 2025/12/31

# stable æ¨¡å¼ - ä½¿ç”¨ç¾æœ‰ query
python3 looker_downloader.py stable --query-id Japtc2w4jUKaJGmWrRRBzj

# slow æ¨¡å¼ - å«é‡è¤‡åµæ¸¬
python3 looker_downloader.py slow --query-id Japtc2w4jUKaJGmWrRRBzj
```

**å·²å°å­˜**ï¼š`looker_custom_downloader.py`ã€`looker_stable_downloader.py`ã€`looker_slow_downloader.py` â†’ `archive/`

---

## 3. é©—è­‰å·¥å…·ï¼ˆæŒçºŒä½¿ç”¨ï¼‰

| è…³æœ¬ | ç”¨é€” | ä½¿ç”¨æ™‚æ©Ÿ |
|------|------|----------|
| `verify_fanout.py` | é©—è­‰ fan-out çµæœå®Œæ•´æ€§ | fan-out å¾ŒåŸ·è¡Œ |
| `verify_store_file_count.py` | æª¢æŸ¥å„åº—å®¶ç›®éŒ„æª”æ¡ˆæ•¸ | å¿«é€Ÿç¨½æ ¸ |
| `verify_store_presence.py` | æª¢æŸ¥åº—å®¶åœ¨å„è³‡æ–™æºçš„å¯ç”¨æ€§ | é™¤éŒ¯ç”¨ |

---

## 4. XGB è½‰æ›ï¼ˆæŒçºŒä½¿ç”¨ï¼‰

| è…³æœ¬ | ç”¨é€” | å‚™è¨» |
|------|------|------|
| `xgb_convert.py` | CLI ç‰ˆè½‰æ›å·¥å…· | ç”¢å‡ºåå–®ç®¡ç† + æŠ•å»£åå–® |
| `xgb_converter_app.py` | GUI ç‰ˆè½‰æ›å·¥å…· | CustomTkinterï¼Œæ”¯æ´æ‹–æ›³ |
| `xgb-build/xgb_converter_app.py` | è¤‡è£½ç‰ˆ | âš ï¸ èˆ‡æ ¹ç›®éŒ„ç‰ˆæœ¬é‡è¤‡ |
| `gen_icon.py` | ç”¢ç”Ÿ App åœ–æ¨™ | ä¸€æ¬¡æ€§ï¼Œå¯å°å­˜ |

---

## 5. ä¸€æ¬¡æ€§è…³æœ¬ï¼ˆå»ºè­°å°å­˜ï¼‰

| è…³æœ¬ | ç”¨é€” | å»ºç«‹æ—¥æœŸ | ç‹€æ…‹ |
|------|------|----------|------|
| `joe-20260121-request.py` | å¯¶é›…éŒ¢åŒ…äº¤æ˜“åˆ†æï¼ˆOMO æœƒå“¡åˆ†é¡ï¼‰ | 2026-01-21 | ğŸ“¦ å¯å°å­˜ |
| `gen_icon.py` | XGB App åœ–æ¨™ç”¢ç”Ÿ | - | ğŸ“¦ å¯å°å­˜ |

---

## 6. å®‰å…¨æ€§å‚™è¨»

âœ… **å·²å®Œæˆ**ï¼šLooker credentials å·²ç§»è‡³ `.env` æª”æ¡ˆ

| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| `.env` | å¯¦éš› credentialsï¼ˆå·²åŠ å…¥ .gitignoreï¼‰ |
| `.env.example` | ç¯„æœ¬æª”æ¡ˆï¼ˆå¯ commitï¼‰ |

ç›¸é—œè…³æœ¬å·²æ›´æ–°ç‚ºä½¿ç”¨ `python-dotenv` è®€å–ç’°å¢ƒè®Šæ•¸ã€‚

---

## 7. å»ºè­°è¡Œå‹•

### çŸ­æœŸï¼ˆå¯ç«‹å³è™•ç†ï¼‰

- [x] ~~ç§»å‹•ä¸€æ¬¡æ€§è…³æœ¬åˆ° `archive/` ç›®éŒ„~~ âœ… 2026-01-29
- [ ] ä¿®æ­£ `fan_out_by_storeid.py` çš„ shebang ä½ç½®
- [x] ~~å°‡ Looker credentials ç§»è‡³ `.env` æª”æ¡ˆ~~ âœ… 2026-01-29

### ä¸­æœŸï¼ˆéœ€è©•ä¼°ï¼‰

- [x] ~~æ•´åˆ 3 å€‹ Looker downloader ç‚ºå–®ä¸€è…³æœ¬~~ âœ… 2026-01-29
- [ ] æŠ½å– `aggregate_by_store.py` çš„é‡è¤‡å‡½æ•¸
- [ ] ç§»é™¤ `xgb-build/` çš„é‡è¤‡è…³æœ¬

### é•·æœŸï¼ˆæ¶æ§‹å„ªåŒ–ï¼‰

- [ ] å»ºç«‹ `looker/` å­ç›®éŒ„ï¼Œçµ±ä¸€ç®¡ç† Looker å·¥å…·
- [ ] å»ºç«‹ `utils/` å…±ç”¨æ¨¡çµ„
- [ ] åŠ å…¥ pytest æ¸¬è©¦

---

## 8. ç›®éŒ„çµæ§‹å»ºè­°

```
91app/
â”œâ”€â”€ tools/                    # æ ¸å¿ƒå·¥å…·
â”‚   â”œâ”€â”€ fan_out.py
â”‚   â”œâ”€â”€ aggregate.py
â”‚   â””â”€â”€ csv_merger.py
â”œâ”€â”€ looker/                   # Looker å·¥å…·
â”‚   â”œâ”€â”€ downloader.py        # æ•´åˆç‰ˆ
â”‚   â”œâ”€â”€ hash_mapper.py
â”‚   â””â”€â”€ query_inspector.py
â”œâ”€â”€ xgb/                      # XGB è½‰æ›
â”‚   â”œâ”€â”€ convert.py
â”‚   â””â”€â”€ app.py
â”œâ”€â”€ verify/                   # é©—è­‰å·¥å…·
â”‚   â”œâ”€â”€ fanout.py
â”‚   â”œâ”€â”€ file_count.py
â”‚   â””â”€â”€ store_presence.py
â”œâ”€â”€ hash-mapper-web/          # Web æœå‹™ï¼ˆç¶­æŒï¼‰
â”œâ”€â”€ archive/                  # å°å­˜
â”‚   â””â”€â”€ joe-20260121-request.py
â””â”€â”€ tests/                    # æ¸¬è©¦ï¼ˆå¾…å»ºç«‹ï¼‰
```

---

## ç‹€æ…‹åœ–ä¾‹

- âœ… ä½¿ç”¨ä¸­ï¼šæŒçºŒä½¿ç”¨ï¼Œå„ªå…ˆç¶­è­·
- ğŸ”´ ä¸»åŠ›ä½¿ç”¨ï¼šé«˜é »ä½¿ç”¨ï¼Œå»ºè­°å„ªåŒ–
- ğŸŸ¡ å¯åˆä½µï¼šåŠŸèƒ½é‡ç–Šï¼Œå»ºè­°æ•´åˆ
- ğŸŸ¢ ä¿ç•™ï¼šå¶çˆ¾ä½¿ç”¨ï¼Œç¶­æŒç¾ç‹€
- ğŸ”§ é–‹ç™¼è¼”åŠ©ï¼šé–‹ç™¼æ™‚ä½¿ç”¨
- ğŸ“¦ å¯å°å­˜ï¼šå·²å®Œæˆä»»å‹™ï¼Œå¯æ­¸æª”
